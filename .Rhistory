chisq.test(p= 0.95, df ==1)
prop.test(p=0.95, df = 1)
prop.test(x=16, n = 80 , correct = FALSE, conf.level = 0.95)
qt(df = 1, 0.95)
qt(df = 1, 0.15)
qt(df = 1, 0.05)
qt(df = 1, 0.05)
qt(df = 1, 0.95)
chisq.test(df = 1, 0.95)
chisq.test(1, 0.95)
1 - qt(df = 1, 0.95)
1 - qt(df = 1, 0.05)
qt(df = 1, 0.05)
prop.test(df= 1, p= 0.05)
prop.test(x=16, n = 80 , correct = FALSE, conf.level = 0.95)
sns.c <- read.csv("snsbyage.csv")
sns.c <- transform(sns.c, age.c = factor(age, levels = c(1,2,3)))
sns.c <- transform(sns.c, service.c = factor(service, levels = c("F","T","K","C","E"), ordered = TRUE))
c.tab <- table(sns.c$age.c, sns.c$service.c)
c.tab
sns.c <- read.csv("snsbyage.csv")
sns.c
sns.c <- transform(sns.c, age.c = factor(age, levels = c(1,2,3)))
sns.c
sns.c <- transform(sns.c, service.c = factor(service, levels = c("F","T","K","C","E"), ordered = TRUE))
sns.c
# H0 = 3개 호수의 산소량이 같다
# H1 = 3개 호수의 산소량이 같지 않다.
data2 <- lm(p ~ h, data=data1)
anova(data2)
d1 <- c(15.5,14.3,16.3,13.5,15.7,16.4,14.7)
d1 <- data.frame(d1)
d1 <- mutate(d1, h = "A")
names(d1)[1] <- c("p")
d2 <- c(14.7,16.3,15.5,15.2,16.3,13.5,15.4)
d2 <- data.frame(d2)
d2 <- mutate(d2, h = "B")
names(d2)[1] <- c("p")
d3 <- c(15.5,13.2,16.5,15.7,15.3,15.2,14.8)
d3 <- data.frame(d3)
d3 <- mutate(d3, h = "C")
names(d3)[1] <- c("p")
data3 <- rbind(d1,d2,d3)
data3
e1 <- c(23,31,13)
e1 <- eata.frame(e1)
e1 <- mutate(e1, h = "반병 이상")
names(e1)[1] <- c("p")
e2 <- c(21,48,23)
e2 <- eata.frame(e2)
e2 <- mutate(e2, h = "반병 이하")
names(e2)[1] <- c("p")
e3 <- c(63,159,119)
e3 <- eata.frame(e3)
e3 <- mutate(e3, h = "못마심")
e1
e1 <- data.frame(e1)
e1 <- mutate(e1, h = "반병 이상")
names(e1)[1] <- c("p")
e2 <- c(21,48,23)
e2 <- data.frame(e2)
e2 <- mutate(e2, h = "반병 이하")
names(e2)[1] <- c("p")
e3 <- c(63,159,119)
e3 <- data.frame(e3)
e3 <- mutate(e3, h = "못마심")
names(e3)[1] <- c("p")
e1
e1 <- c(23,31,13)
e1 <- data.frame(e1)
names(e1)[1] <- c("1갑이상")
e2 <- c(21,48,23)
e2 <- data.frame(e2)
names(e2)[1] <- c("1갑이하")
e3 <- c(63,159,119)
e3 <- data.frame(e3)
names(e3)[1] <- c("안피움")
e1
cbind(e1,e2,e3)
rownames(e5) = c("반병이상","반병이하","못마심")
e5 <- cbind(e1,e2,e3)
rownames(e5) = c("반병이상","반병이하","못마심")
e5
chisq.test(e5)
# H0 = p = 0.15
# H1 = p != 0.15
chisq.test(p= 0.95, df ==1)
chisq.test(df = 1, 0.95)
prop.test(df= 1, p= 0.05)
prop.test(x=16, n = 64 , correct = FALSE)
d <- c(64, 16)
chisq.test(d, p = c(0.85, 0.15))
dchisq(1)
dchisq(df= 1)
dchisq(df= 1, p = 0.05)
dchisq(1,0.05)
dchisq(0.05,1)
qchisq(0.95,1)
chisq.test(c(64,16), p = c(0.85, 0.15))
qchisq(0.95,1)
qchisq(0.95,1)
chisq.test(c(64,16), p = c(0.85, 0.15))
library(dplyr)
library(plyr)
c1 <- c(5,7,6,8,6,7,8,8,6,10)
c1 <- data.frame(c1)
c1 <- mutate(c1, h = "1")
names(c1)[1] <- c("p")
c2 <- c(6,8,9,11,13,12,10,8,9,10)
c2 <- data.frame(c2)
c2 <- mutate(c2, h = "2")
names(c2)[1] <- c("p")
c3 <- c(14,25,26,18,19,22,21,16,20,30)
c3 <- data.frame(c3)
c3 <- mutate(c3, h = "3")
names(c3)[1] <- c("p")
data1 <- rbind(c1,c2,c3)
class(data1$h)
# H0 = 3개 호수의 산소량이 같다
# H1 = 3개 호수의 산소량이 같지 않다.
data2 <- lm(p ~ h, data=data1)
anova(data2)
d1 <- c(15.5,14.3,16.3,13.5,15.7,16.4,14.7)
d1 <- data.frame(d1)
d1 <- mutate(d1, h = "A")
names(d1)[1] <- c("p")
d2 <- c(14.7,16.3,15.5,15.2,16.3,13.5,15.4)
d2 <- data.frame(d2)
d2 <- mutate(d2, h = "B")
names(d2)[1] <- c("p")
d3 <- c(15.5,13.2,16.5,15.7,15.3,15.2,14.8)
d3 <- data.frame(d3)
d3 <- mutate(d3, h = "C")
names(d3)[1] <- c("p")
data3 <- rbind(d1,d2,d3)
class(data3$h)
# H0 = 3개 채소의 가격이 같다.
# H1 = 3개 채소의 가격이 같지 않다.
data4 <- lm(p ~ h, data=data3)
anova(data4)
anova(data4)
library(prob)
# H0 = p = 0.15
# H1 = p != 0.15
qchisq(0.95,1)
chisq.test(c(64,16), p = c(0.85, 0.15))
e1 <- c(23,31,13)
e1 <- data.frame(e1)
names(e1)[1] <- c("1갑이상")
e2 <- c(21,48,23)
e2 <- data.frame(e2)
names(e2)[1] <- c("1갑이하")
e3 <- c(63,159,119)
e3 <- data.frame(e3)
names(e3)[1] <- c("안피움")
e5 <- cbind(e1,e2,e3)
rownames(e5) = c("반병이상","반병이하","못마심")
# H0 = 음주량과 흡연량 사이에 연관이 있다.
# H1 = 음주량과 흡연량 사이에 연관이 없다.
chisq.test(e5)
ata20 <- mpg
ata20 <- mpg
library(ggplot2)
ata20 <- mpg
data30 <- filter(data20, data20$class == 'subcompact')
ata20 <- mpg
data30 <- filter(data20, data20$class == 'subcompact')
data31 <- filter(data30, data30$drv == 'r')
library(dplyr)
ata20 <- mpg
data30 <- filter(data20, data20$class == 'subcompact')
ata20 <- mpg
data30 <- filter(data20, data20$class == 'subcompact')
data20 <- mpg
data30 <- filter(data20, data20$class == 'subcompact')
data31 <- filter(data30, data30$drv == 'r')
data32 <- filter(data30, data30$drv == 'f')
data33 <- rbind(data31, data32)
data20 <- mpg
data30 <- filter(data20, data20$class == 'subcompact')
data30
data20 <- mpg
data20
data30 <- filter(data20, data20$class == 'subcompact')
data30 <- filter(data20, data20$class == 'subcompact')
data31 <- filter(data30, data30$drv == 'r')
data32 <- filter(data30, data30$drv == 'f')
# H0 = 3개 호수의 산소량이 같다
# H1 = 3개 호수의 산소량이 같지 않다.
data2 <- lm(p ~ h, data=data1)
anova(data2)
d1 <- c(15.5,14.3,16.3,13.5,15.7,16.4,14.7)
d1 <- data.frame(d1)
d1 <- mutate(d1, h = "A")
names(d1)[1] <- c("p")
d2 <- c(14.7,16.3,15.5,15.2,16.3,13.5,15.4)
d2 <- data.frame(d2)
d2 <- mutate(d2, h = "B")
names(d2)[1] <- c("p")
d3 <- c(15.5,13.2,16.5,15.7,15.3,15.2,14.8)
d3 <- data.frame(d3)
d3 <- mutate(d3, h = "C")
names(d3)[1] <- c("p")
data3 <- rbind(d1,d2,d3)
class(data3$h)
# H0 = 3개 채소의 가격이 같다.
# H1 = 3개 채소의 가격이 같지 않다.
data4 <- lm(p ~ h, data=data3)
anova(data4)
# H0 = 3개 채소의 가격이 같다.
# H1 = 3개 채소의 가격이 같지 않다.
data4 <- lm(p ~ h, data=data3)
library(dplyr)
library(plyr)
c1 <- c(5,7,6,8,6,7,8,8,6,10)
c1 <- data.frame(c1)
c1 <- mutate(c1, h = "1")
names(c1)[1] <- c("p")
c2 <- c(6,8,9,11,13,12,10,8,9,10)
c2 <- data.frame(c2)
c2 <- mutate(c2, h = "2")
names(c2)[1] <- c("p")
c3 <- c(14,25,26,18,19,22,21,16,20,30)
c3 <- data.frame(c3)
c3 <- mutate(c3, h = "3")
names(c3)[1] <- c("p")
data1 <- rbind(c1,c2,c3)
class(data1$h)
# H0 = 3개 호수의 산소량이 같다
# H1 = 3개 호수의 산소량이 같지 않다.
data2 <- lm(p ~ h, data=data1)
anova(data2)
anova(data2)
data2
data1 <- rbind(c1,c2,c3)
class(data1$h)
data1
data1
data2
help
good
dplyr?
fd
?dplyr
read.table("Galton.txt", header = T)
data1 <- read.table("Galton.txt", header = T)
View(data1)
data1 <- read.table("Galton.txt")
View(data1)
View(data1)
data1 <- read.table("pm10.traffic.accident.cvs")
data1 <- read.csv("pm10.traffic.accident.csv")
data1
data <- read.table("Galton.txt")
data
plot(data)
View(data)
names(data) <-c("fater", "mather")
data
View(data)
data$
fit
fit
state.x77
states <- as.data.frame(state.x77[,c("Murder", "Population","Illiteracy","Income","Frost")])
states
fit <- lm(Murder~ Population+Illiteracy+Income+Frost)
fit <- lm(Murder~ Population+Illiteracy+Income+Frost, data=states)
fit
summary(fit)
plot(fit)
plot(fit)
par(mfrow=c(2,2))
par(mfrow=c(2,2))
par(mfrow=c(2,2))
par(mfrow=c(2,2))
par(mfrow=c(2,2))
plot(fit)
fit3 <- lm((Murder~1,data=states)
fit3 <- lm((Murder ~ 1,data=states)
fit3 <- lm((Murder ~ 1, data=states)
fit3 <- lm((Murder ~ 1, data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
fit3 <- lm((Murder ~ 1 , data = states)
state.x77
states <- as.data.frame(state.x77[,c("Murder", "Population","Illiteracy","Income","Frost")])
fit3 <- lm((Murder ~ 1 , data = states)
install.packages("leaps")
library(leaps)
fit3 <- lm(Murder ~ 1 , data = states)
x <- c(150,  160,  170,  180,  190)
y <- c(176,  179,  182,  181,  185)
data.frame(x,y)
g <- data.frame(x,y)
g
g <- data.frame(x,y)
x <- c(150,  160,  170,  180,  190)
y <- c(176,  179,  182,  181,  185)
g <- data.frame(x,y)
View(g)
fit <- lm(y ~ x, data=g)
summary(fit)
function(x) {
y = 0.2x + 146
}
# y = 0.2x + 146
a <- function(x) {
y = 0.2x + 146
}
a <- function(x) {
y = 0.2x + 146
}
y = 0.2x + 146 }
fit <- lm(x ~ y, data=g)
summary(fit)
c <- c(100,  200,  300,  400,  500)
d <- c( 30,    70,    85,  140,  197)
f <- data.frame(c,d)
fit2 <- lm(c ~ d, data=g)
summary(fit2)
fit2 <- lm(c ~ d, data=g)
summary(fit2)
mtcars
data <- mtcars[,c("disp","hp")]
data
fit <- lm(disp ~ hp, data=data)
fit3 <- lm(disp ~ hp, data=data)
fit <- lm(x ~ y, data=g)
summary(fit)
summary(fit3)
MASS
install.packages("MASS")
library(MASS)
Boston
data1 <- Boston
View(data1)
head(data1)
fit4 <- lm(medv ~ crim+ zn +indus chas +  nox  +  rm+  age+
dis +rad+ tax+ ptratio + black +lstat, data=data1)
fit4 <- lm(medv ~ crim + zn + indus + chas +  nox  +  rm+  age+
dis +rad+ tax+ ptratio + black +lstat, data=data1)
summary(fit4)
fit4 <- lm(medv ~ crim + zn + indus + chas +  nox  +  rm+  age+
dis +rad+ tax+ ptratio + black +lstat, data=data1
family = "binomial")
fit4 <- lm(medv ~ crim + zn + indus + chas +  nox  +  rm+  age+
dis +rad+ tax+ ptratio + black +lstat, data=data1,
family = "binomial")
fit4 <- lm(medv ~ crim + zn + indus + chas +  nox  +  rm+  age+
dis +rad+ tax+ ptratio + black +lstat, data=data1,
family = "binomial")
step(fit4, direction = 'backward')
step(fit4, direction = 'backward')
fit4 <- lm(medv ~ crim + zn + indus + chas +  nox  +  rm+  age+
dis +rad+ tax+ ptratio + black +lstat, data=data1)
step(fit4, direction = 'backward')
lm(formula = medv ~ crim + zn + chas + nox + rm + dis + rad +
tax + ptratio + black + lstat, data = data1)
lm(formula = medv ~ crim + zn + chas + nox + rm + dis + rad +
tax + ptratio + black + lstat, data = data1)
summary(fit5)
summary(data5)
data5 <- lm(formula = medv ~ crim + zn + chas + nox + rm + dis + rad +
tax + ptratio + black + lstat, data = data1)
summary(data5)
library(leaps)
any(is.na(data1))#데이터 중에 NA 결측치 값의 존재여부를 판단
add1(leastm, fullm, test="F")
add1(fit4, fullm, test="F")
add1(leastm, fit4, test="F")
step(fit4, direction = 'backward')
step(fit4, direction = 'backward')
step(fit4, direction = 'Forward')
step(fit4, direction = 'stepwise')
fit4 <- lm(medv ~ crim + zn + indus + chas +  nox  +  rm+  age+
dis +rad+ tax+ ptratio + black +lstat, data=data1)
step(fit4, direction = 'Forward')
data1 <- Boston
head(data1)
any(is.na(data1))#데이터 중에 NA 결측치 값의 존재여부를 판단
fit4 <- lm(medv ~ crim + zn + indus + chas +  nox  +  rm+  age+
dis +rad+ tax+ ptratio + black +lstat, data=data1)
step(fit4, direction = 'Forward')
step(fit4, direction = 'Forward')
step(fit4, direction = 'backward') #대부분 사용
step(fit4, direction = 'Forward')
step(fit4, direction = 'stepwise')
step(fit4, direction = 'both')
summary(fit4)
fit5 <- lm(medv ~ crim + zn + chas +  nox  +  rm+
dis +rad+ tax+ ptratio + black +lstat, data=data1)
fit5 <- lm(medv ~ crim + zn + chas +  nox  +  rm+
dis +rad+ tax+ ptratio + black +lstat, data=data1)
summary(fit5)
step(fit4, direction = 'both')
step(fit5, direction = 'backward') #대부분 사용
step(fit4, direction = 'both')
step(fit5, direction = 'both')
par(mfrow=c(2,2))
plot(fit4)
plot(fit4)
data1
summary(data1)
fit5 <- lm(medv ~ crim + zn + chas +  nox  +  rm+
dis +rad+ tax+ ptratio + black +lstat, data=data1)
plot(fit5)
fit5 <- lm(medv ~ crim + zn + chas +  nox  +  rm+
dis +rad+ tax+ ptratio + black +lstat, data=data1)
summary(fit5)
plot(fit5)
sdf
par(mfrow=c(2,2))
plot(fit5)
install.packages("car")
vif(fit4)
install.packages("car", dependencies = TRUE)
library(car)
vif(fit4)
sqrt(vif(fit4))
vif(fit4)
plot(fit)
x <- c(150,  160,  170,  180,  190)
y <- c(176,  179,  182,  181,  185)
g <- data.frame(x,y)
fit <- lm(x ~ y, data=g)
plot(fit)
influencePlot(fit4, id.method = "identify")
par(mfrow=c(1,1))
influencePlot(fit4, id.method = "identify")
influencePlot(fit4, id.method = "identify")
influencePlot(fit4, id.method = "identify")
data1 <- Boston
head(data1)
any(is.na(data1))#데이터 중에 NA 결측치 값의 존재여부를 판단
summary(data1)
fit4 <- lm(medv ~ crim + zn + indus + chas +  nox  +  rm+  age+
dis +rad+ tax+ ptratio + black +lstat, data=data1)
par(mfrow=c(1,1))
influencePlot(fit4, id.method = "identify")
View(data1)
View(data1)
data1[381,]
mean(data1$crim)
sd(data1$crim)
library(dplyr)
arrange(data1$crim)
arrange(data1, data1$crim)
arrange(data1, desc(data1$crim))
sqrt(vif(fit4))
sqrt(vif(fit4)) #루투 VIF값이 2이상이면 다중공산성이 충분이 있다고 보여진다.
# tax 제거
fit4 <- lm(medv ~ crim + zn + indus + chas +  nox  +  rm+  age+
dis +rad+ ptratio + black +lstat, data=data1)
sqrt(vif(fit4))
fit4 <- lm(medv ~ crim + zn + indus + chas +    rm+  age+
dis +rad+ ptratio + black +lstat, data=data1)
sqrt(vif(fit4))
plot(fit4)
step(fit4, direction = 'backward') #대부분 사용
step(fit4, direction = 'Forward')
step(fit5, direction = 'both')
step(fit4, direction = 'backward') #대부분 사용
step(fit4, direction = 'backward') #대부분 사용
step(fit4, direction = 'backward') #대부분 사용
summary(fit4)
fit4 <- lm(medv ~ crim + zn + indus + chas +    rm+
dis +rad+ ptratio + black +lstat, data=data1)
summary(fit4)
sqrt(vif(fit4))
step(fit4, direction = 'backward') #대부분 사용
# 유의확률 0.05미만으로 영향력이 없다고 판단하여  age제거 후 분석
fit4 <- lm(medv ~ crim + zn + indus + chas +    rm+
dis +rad+ ptratio + black +lstat, data=data1)
summary(fit4)
sqrt(vif(fit4))
# 유의확률 0.05미만으로 영향력이 없다고 판단하여  rad제거 후 분석
fit4 <- lm(medv ~ crim + zn + indus + chas +    rm+
dis + ptratio + black +lstat, data=data1)
summary(fit4)
sqrt(vif(fit4))
summary(fit4)
step(fit4, direction = 'backward') #대부분 사용
summary(fit4)
par(mfrow=c(2,2))
plot(fit4)
#최종 모형
lm(medv ~ crim + zn + indus + chas +    rm+
dis + ptratio + black +lstat, data=data1)
